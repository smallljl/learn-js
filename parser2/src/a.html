<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>
    let LinkedList = [];
    const CACHE_SIZE = 10;
   
    class PeekIterator {
        constructor(it,endToken = null){
            this.it = it;
            // 需要putBack的元素
            this.stackPutBacks = [];
            debugger
            // 基于时间窗口的缓存
            this.queueCache = [];
            this.endToken = endToken;
        }
        peek(){
            if(this.stackPutBacks.length > 0){
                return this.stackPutBacks.head;
            }
            const val = this.next();
            this.stackPutBacks();
            return val;
        }
        pubBack(){
            if(this.queueCache.length > 0){
                this.stackPutBacks.push(this.queueCache.pop());
            }
        }
        next(){
            let val = null;
            if(this.stackPutBacks.length > 0){
                val = this.stackPutBacks.pop();
            } else {
                val = this.it.next().value;
                if(val === undefined){
                    const tmp = this.endToken;
                    this.endToken = null;
                    return tmp
                }
            }
            // 处理缓存
            while(this.queueCache.length > CACHE_SIZE -1){
                this.queueCache.shift();
            }
            this.queueCache.push(val);
            return val;
        }
        hasNext(){
            return  this.endToken || !!this.peek();
        }
    }

    function * arrayToGenerator(arr){
        for(let i = 0; i < arr.length; i++){
            yield arr[i];
        }
    }

    const it = new PeekIterator(arrayToGenerator([..."abcdefg"]));
   
  </script>
</body>
</html>